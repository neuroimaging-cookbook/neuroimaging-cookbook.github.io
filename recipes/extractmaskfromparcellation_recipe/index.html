<!doctype html><html lang=en class=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.79.0"><link rel=apple-touch-icon sizes=180x180 href=https://neuroimaging-cookbook.github.io/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://neuroimaging-cookbook.github.io/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://neuroimaging-cookbook.github.io/favicons/favicon-16x16.png><link rel=manifest href=https://neuroimaging-cookbook.github.io/favicons/site.webmanifest><link rel=mask-icon href=https://neuroimaging-cookbook.github.io/favicons/safari-pinned-tab.svg color=#004750><link rel="shortcut icon" href=https://neuroimaging-cookbook.github.io/favicons/favicon.ico><meta name=msapplication-config content="https://neuroimaging-cookbook.github.io/favicons/browserconfig.xml"><title>Using 3dcalc to create a binary mask from a parcellation scheme | Neuroimaging Cookbook</title><meta property="og:title" content="Using 3dcalc to create a binary mask from a parcellation scheme"><meta property="og:description" content="This recipe uses 3dcalc in AFNI to output a binarized 3D image file (nifti) of a region-of-interest in a parcellation scheme that is indexed by number of parcels.
Ingredients:
 AFNI>=20.3.03 3dcalc  Example usage: This example uses the Harvard Oxford Atlas
1 2 3 4 5 6 7  #!/bin/bash  ATLAS_FILENAME='Harvard_Oxford_Atlas.nii.gz' MASK_NAME='r_amygdala' ROI_INDEX=102 # index assigned to parcel/region of interest in atlas parcellation scheme (the index for right amygdala in Harvard Oxford atlas is 102) 3dcalc -a ${ATLAS_FILENAME} -prefix ${MASK_NAME}."><meta property="og:type" content="article"><meta property="og:url" content="https://neuroimaging-cookbook.github.io/recipes/extractmaskfromparcellation_recipe/"><meta property="article:published_time" content="2020-12-14T00:00:00+00:00"><meta property="article:modified_time" content="2021-12-12T15:30:39+00:00"><meta itemprop=name content="Using 3dcalc to create a binary mask from a parcellation scheme"><meta itemprop=description content="This recipe uses 3dcalc in AFNI to output a binarized 3D image file (nifti) of a region-of-interest in a parcellation scheme that is indexed by number of parcels.
Ingredients:
 AFNI>=20.3.03 3dcalc  Example usage: This example uses the Harvard Oxford Atlas
1 2 3 4 5 6 7  #!/bin/bash  ATLAS_FILENAME='Harvard_Oxford_Atlas.nii.gz' MASK_NAME='r_amygdala' ROI_INDEX=102 # index assigned to parcel/region of interest in atlas parcellation scheme (the index for right amygdala in Harvard Oxford atlas is 102) 3dcalc -a ${ATLAS_FILENAME} -prefix ${MASK_NAME}."><meta itemprop=datePublished content="2020-12-14T00:00:00+00:00"><meta itemprop=dateModified content="2021-12-12T15:30:39+00:00"><meta itemprop=wordCount content="124"><meta itemprop=keywords content="extract,mask,binarize,parcellation,roi,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using 3dcalc to create a binary mask from a parcellation scheme"><meta name=twitter:description content="This recipe uses 3dcalc in AFNI to output a binarized 3D image file (nifti) of a region-of-interest in a parcellation scheme that is indexed by number of parcels.
Ingredients:
 AFNI>=20.3.03 3dcalc  Example usage: This example uses the Harvard Oxford Atlas
1 2 3 4 5 6 7  #!/bin/bash  ATLAS_FILENAME='Harvard_Oxford_Atlas.nii.gz' MASK_NAME='r_amygdala' ROI_INDEX=102 # index assigned to parcel/region of interest in atlas parcellation scheme (the index for right amygdala in Harvard Oxford atlas is 102) 3dcalc -a ${ATLAS_FILENAME} -prefix ${MASK_NAME}."><link rel=stylesheet href=https://neuroimaging-cookbook.github.io/css/styles.c5f4f557b68d0806cb2a1f821ba5e4c4b343ecbed3a87f17d3ebabf3538c0424353554e5f0186f700ee306a8f20bb6f326958cc06c8ce62c0961a8798181dcd1.css integrity="sha512-xfT1V7aNCAbLKh+CG6XkxLND7L7TqH8X0+ur81OMBCQ1NVTl8BhvcA7jBqjyC7bzJpWMwGyM5iwJYah5gYHc0Q=="></head><body class=page-page><header class=nav_header><nav class="wrap nav menu"><a href=https://neuroimaging-cookbook.github.io/ class=nav_brand><picture data-lit=https://neuroimaging-cookbook.github.io/images/logo_lightmode.png data-dark=https://neuroimaging-cookbook.github.io/images/logo_darkmode.png>
<source srcset=https://neuroimaging-cookbook.github.io/images/logo_darkmode.png media="(prefers-color-scheme: dark)"><img srcset=https://neuroimaging-cookbook.github.io/images/logo_lightmode.png alt="Neuroimaging Cookbook Logo"></picture>
<label class="nav_toggle toggle" title="Site Menu" role=button><svg class="icon"><use xlink:href="#harmburger"/></svg></label></a><ul class=nav_body><li class=nav-item><div class=search><label for=find class=search_label><svg class="icon"><use xlink:href="#search"/></svg></label><input type=search class=search_field placeholder="Search the docs ..." id=find autocomplete=off><div class="search_results results"></div></div></li><li class=nav-item><a class=nav-link href=https://neuroimaging-cookbook.github.io/><span>Recipes</span></a></li><li class=nav-item><a class=nav-link href=https://neuroimaging-cookbook.github.io/about><span>About</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/neuroimaging-cookbook/neuroimaging-cookbook.github.io target=_blank>GitHub</a></li><li class=nav-item><div class=color_mode><label for=mode></label><input type=checkbox class=color_choice id=mode title="Toggle Dark Mode"></div></li></ul></nav></header><div class="main pt-2"><div class="wrap grid-middle"><div class="content content-accent"><h1>Using 3dcalc to create a binary mask from a parcellation scheme</h1><p>This recipe uses 3dcalc in AFNI to output a binarized 3D image file (nifti) of a region-of-interest in a parcellation scheme that is indexed by number of parcels.</p><p>Ingredients:</p><ul><li><a href=https://afni.nimh.nih.gov/pub/dist/doc/htmldoc/index.html>AFNI>=20.3.03</a></li><li><a href=https://afni.nimh.nih.gov/pub/dist/doc/program_help/3dcalc.html>3dcalc</a></li></ul><h2 id=example-usage>Example usage:</h2><p>This example uses the <a href=http://www.nitrc.org/frs/download.php/9902/HarvardOxford.tgz>Harvard Oxford Atlas</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=cp>#!/bin/bash
</span><span class=cp></span>
<span class=nv>ATLAS_FILENAME</span><span class=o>=</span><span class=s1>&#39;Harvard_Oxford_Atlas.nii.gz&#39;</span>
<span class=nv>MASK_NAME</span><span class=o>=</span><span class=s1>&#39;r_amygdala&#39;</span>
<span class=nv>ROI_INDEX</span><span class=o>=</span><span class=m>102</span> <span class=c1># index assigned to parcel/region of interest in atlas parcellation scheme (the index for right amygdala in Harvard Oxford atlas is 102)</span>

3dcalc -a <span class=si>${</span><span class=nv>ATLAS_FILENAME</span><span class=si>}</span> -prefix <span class=si>${</span><span class=nv>MASK_NAME</span><span class=si>}</span>.nii.gz -expr <span class=s2>&#34;amongst(a,</span><span class=si>${</span><span class=nv>ROI_INDEX</span><span class=si>}</span><span class=s2>)&#34;</span>
</code></pre></td></tr></table></div></div><p>You can also extract all parcels using a .txt file containing a parcel name on each row:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=cp>#!/bin/bash
</span><span class=cp></span>
<span class=nv>ATLAS_FILENAME</span><span class=o>=</span><span class=s1>&#39;Harvard_Oxford_Atlas.nii.gz&#39;</span>
<span class=nv>MASKLIST_FILENAME</span><span class=o>=</span><span class=s1>&#39;Harvard_Oxford_Atlas_ROIs.txt&#39;</span>

<span class=nv>ROI_INDEX</span><span class=o>=</span><span class=m>0</span>
<span class=k>for</span> MASK_NAME in <span class=k>$(</span>cat <span class=s2>&#34;</span><span class=si>${</span><span class=nv>MASKLIST_FILENAME</span><span class=si>}</span><span class=s2>); do
</span><span class=s2>    ROI_INDEX=</span><span class=k>$((</span>COUNTER+1<span class=k>))</span><span class=s2>
</span><span class=s2>    3dcalc -a </span><span class=si>${</span><span class=nv>ATLAS_FILENAME</span><span class=si>}</span><span class=s2> -prefix </span><span class=si>${</span><span class=nv>MASK_NAME</span><span class=si>}</span><span class=s2>.nii.gz -expr &#34;</span>amongst<span class=o>(</span>a,<span class=si>${</span><span class=nv>ROI_INDEX</span><span class=si>}</span><span class=k>)</span><span class=s2>&#34;
</span><span class=s2>done
</span></code></pre></td></tr></table></div></div><p class="text-center p-0">Recipe made by<a href=https://github.com/shawnrhoads> Shawn Rhoads</a></div><h2 class=text-center>These recipes may also be of interest</h2><ul><li class=content-accent><a href=/recipes/automatically-generated-recipe/><h3 class=active>Automatically Generated Recipe</h3></a><a class="post_tag button button_translucent" href=https://neuroimaging-cookbook.github.io/languages/python/>python</a>
<a class="post_tag button button_translucent" href=https://neuroimaging-cookbook.github.io/languages/r/>r</a>
<a class="post_tag button button_translucent" href=https://neuroimaging-cookbook.github.io/languages/bash/>bash</a><p>Explain briefly what the recipe does. Explain briefly how the recipe works. Provide a citation and link to documentation of any third party …
<a href=https://neuroimaging-cookbook.github.io/recipes/automatically-generated-recipe/ class=active>Read More</a></p></li><li class=content-accent><a href=/recipes/dcm2nii_recipe/><h3 class=active>Convert DICOM files to NIFTI files</h3></a><p>This recipe provides code for converting DICOM (.dcm) files to NIFTI (.nii) files
dcm2niix This recipe converts dicom to nifti files using …
<a href=https://neuroimaging-cookbook.github.io/recipes/dcm2nii_recipe/ class=active>Read More</a></p></li><li class=content-accent><a href=/recipes/flattenrdm_recipe/><h3 class=active>Mask lower triangle of a Representational Dissimilarity Matrix (RDM)</h3></a><a class="post_tag button button_translucent" href=https://neuroimaging-cookbook.github.io/languages/python/>python</a><p>This recipe takes a Representational Dissimilarity Matrix (RDM) as a square numpy array, masks the diagonal and lower triangle, and outputs …
<a href=https://neuroimaging-cookbook.github.io/recipes/flattenrdm_recipe/ class=active>Read More</a></p></li><li class=content-accent><a href=/recipes/brikhead2nii_recipe/><h3 class=active>Using 3dAFNItoNIFTI to convert AFNI files to NIFTI files</h3></a><p>This recipe converts BRIK/HEAD (AFNI) files to NIFTI (.nii) files using 3dAFNItoNIFTI. …
<a href=https://neuroimaging-cookbook.github.io/recipes/brikhead2nii_recipe/ class=active>Read More</a></p></li></ul></div></div><footer class="pt-2 pb-2"><div class=wrap><p>&copy; <span class=year>2021</span> <a href=https://github.com/neuroimaging-cookbook/neuroimaging-cookbook.github.io target=_blank rel=noopener>Neuroimaging Cookbook Contributors</a></p></div></footer><svg width="0" height="0" class="hidden"><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 492.004 492.004" id="next"><path d="M484.14 226.886 306.46 49.202c-5.072-5.072-11.832-7.856-19.04-7.856-7.216.0-13.972 2.788-19.044 7.856l-16.132 16.136c-5.068 5.064-7.86 11.828-7.86 19.04.0 7.208 2.792 14.2 7.86 19.264L355.9 207.526H26.58C11.732 207.526.0 219.15.0 234.002v22.812c0 14.852 11.732 27.648 26.58 27.648h330.496L252.248 388.926c-5.068 5.072-7.86 11.652-7.86 18.864.0 7.204 2.792 13.88 7.86 18.948l16.132 16.084c5.072 5.072 11.828 7.836 19.044 7.836 7.208.0 13.968-2.8 19.04-7.872l177.68-177.68c5.084-5.088 7.88-11.88 7.86-19.1.016-7.244-2.776-14.04-7.864-19.12z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.999 511.999" id="search"><path d="M508.874 478.708 360.142 329.976c28.21-34.827 45.191-79.103 45.191-127.309C405.333 90.917 314.416.0 202.666.0S0 90.917.0 202.667s90.917 202.667 202.667 202.667c48.206.0 92.482-16.982 127.309-45.191l148.732 148.732c4.167 4.165 10.919 4.165 15.086.0l15.081-15.082c4.165-4.166 4.165-10.92-.001-15.085zM202.667 362.667c-88.229.0-160-71.771-160-160s71.771-160 160-160 160 71.771 160 160-71.771 160-160 160z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 241 179" id="harmburger"><path d="M1 10C1 4.477 5.477.0 11 0h220c5.523.0 10 4.477 10 10s-4.477 10-10 10H11C5.477 20 1 15.523 1 10zm0 80c0-5.523 4.477-10 10-10h220c5.523.0 10 4.477 10 10s-4.477 10-10 10H11c-5.523.0-10-4.477-10-10zm9 69c-5.523.0-10 4.477-10 10s4.477 10 10 10h220c5.523.0 10-4.477 10-10s-4.477-10-10-10H10z"/></symbol></svg><script src=https://neuroimaging-cookbook.github.io/js/bundle.min.5af5a71cb7087a1e6a1579c029c74e083fa41198bfb107602ad29f77f53a4748cb3f09e998b78e1a26c952cede95c2f4d402b88c25591b16ff59f800220e4246.js></script><script src=https://neuroimaging-cookbook.github.io/js/search.min.d9760d323b902b0d8256ad2f5238264e3d572dfbf6dcb818ebbeacebc895cd2c7de2a7525b1a855d77255e87974f1b0a9e1b406b661bc41c02a6e993b59ed5d5.js async defer></script></body></html>